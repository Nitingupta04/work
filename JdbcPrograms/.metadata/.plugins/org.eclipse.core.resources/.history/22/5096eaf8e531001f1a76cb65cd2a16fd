package com.jtcindia.jdbceg;

import java.sql.Connection;
import java.sql.ResultSet;
import java.sql.Statement;

import com.jtcindia.jdbcutilall.JDBCUtill;

public class Jtc1 {

	public static void main(String[] args) {
		System.out.println("-- Java Program Started Runing --");

		Connection con = null;
		Statement st = null;
		ResultSet rs = null;

		try {

			// Our Query
			String q1 = "insert into users values (109,'Krishna','Krishna@gmail.com',988789,'Bhopal')";
			String q2 = "delete from users where id=109";
			String q3 = "select * from users";
			String q4 = "update from users where id=105"

			// Getting Connection with Database
			con = JDBCUtill.getConnection();

			// Creating statement
			st = con.createStatement();

			// Inserting records into DB
//			int i = st.executeUpdate(q1);
//			if (i == 1) {
//				System.out.println("-- Users Record Added Sucessfully --");
//			} else {
//				System.out.println("-- Sorry Users Record Not Inserted --");
//			}

//			//Delete Eg
//			boolean bn = st.execute(q2);
//			System.out.println(bn);

			// Getting Data from the DB
			st.execute(q3);
			rs = st.getResultSet();
			int count = 0;
			while (rs.next()) {

				int id = rs.getInt(1);
				String name = rs.getString(2);
				String email = rs.getString(3);
				long phone = rs.getLong(4);
				String city = rs.getString(5);

				System.out.print("Id = " + id + " | ");
				System.out.print("Name = " + name + " | ");
				System.out.print("Email = " + email + " | ");
				System.out.print("Phone = " + phone + " | ");
				System.out.print("City = " + city + " | ");				
				System.out.println();
				count ++;
			}
			
			System.out.println("-- Total  "+count+" Records Found Inside DataBase --");

		} catch (Exception e) {
			e.printStackTrace();
		}

		finally {
			JDBCUtill.cleanup(st, con, rs);
			System.out.println("-- All Resources Cleaned --");

		}

	}

}
